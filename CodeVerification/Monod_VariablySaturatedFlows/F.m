function [fs,fg,fh,VxE,VyE]=F(t,x,y)

[X,Y] = meshgrid(x,y) ; 
    % % with Matlab:
%     syms p(t,x,y)
%     p = -t*x*(2-x)*y*(3-y)+x/4+y/4;
%     syms c1(t,x,y)
%     c1 = x*(2-x)*y^3*exp(-0.1*t)/27;
%     syms c2(t,x,y)
%     c2 = (x-1)^2*y^2*exp(-0.1*t)/9;
%     theta = 1/(3.3333-p);
%     K= 0.05;
%     theta_sat=0.3;
%     D1=0.025; D2=D1;
solEp = @(t,x,y)  -t.*x.*(2-x).*y.*(3-y)+x/4+y/4;
%     Vx=-K*(diff(p, x))
%     Vx=(t*x*y*(y - 3))/20 + (t*y*(x - 2)*(y - 3))/20 - 1/80
      solVx = @(t,x,y) (t*x.*y.*(y - 3))/20 + (t*y.*(x - 2).*(y - 3))/20 - 1/80;
%     Vy =-K*(diff(p+y, y))
%     Vy=(t*x*y*(x - 2))/20 + (t*x*(x - 2)*(y - 3))/20 - 1/16
      solVy = @(t,x,y) (t*x.*y.*(x - 2))/20 + (t*x.*(x - 2).*(y - 3))/20 - 1/16;
      VxE = solVx(t,X,Y);
      VyE = solVy(t,X,Y);    
%     F1 = diff(theta,t)+diff(Vx,x)+diff(Vy,y)
      F1 = @(t,x,y) (t*x.*(x - 2))/10 + (t*y.*(y - 3))/10 - (x.*y.*(x - 2).*(y - 3))./(x/4 + y/4 - t*x.*y.*(x - 2).*(y - 3) - 33333/10000).^2;
%     F2 = -K*diff(diff(p,x),x)-K*diff(diff(p+y,y),y)
      F2 = @(t,x,y) (t*x.*(x - 2))/10 + (t*y.*(y - 3))/10;

% % a1=1; a2=3; M1=2; M2=0.2;
% % m=1e-3*(c1/(2+c1))*(c2/(0.2+c2));
% % c1(2:J-1,2:I-1)=c01(2:J-1,2:I-1)-dt*a1*m(2:J-1,2:I-1);
% % c2(2:J-1,2:I-1)=c02(2:J-1,2:I-1)-dt*a2*m(2:J-1,2:I-1);

%     m = (x*y^5*exp(-t/5)*(x - 1)^2*(x - 2))/(243000*((y^2*exp(-t/10)*(x - 1)^2)/9 + 1/5)*((x*exp(-t/10)*(x - 2)*y^3)/27 - 2));
%     R1=-m*theta;
%     R2=-3*m*theta;
%     R1s=-m*theta_sat;
%     R2s=-3*m*theta_sat;        
%     G1 = diff(theta*c1,t)+diff(Vx*c1,x)+diff(Vy*c1,y)-D1*diff(diff(c1,x),x)-D2*diff(diff(c1,y),y)-R1
      G1 = @(t,x,y) (y.^3*exp(-t/10))/540 - (y.^3*exp(-t/10).*(x - 2).*((t*x.*y.*(y - 3))/20 + (t*y.*(x - 2).*(y - 3))/20 - 1/80))/27 ...
          + (x.*y*exp(-t/10).*(x - 2))/180 - (x.*y.^3*exp(-t/10).*((t*x.*y.*(y - 3))/20 + (t*y.*(x - 2).*(y - 3))/20 - 1/80))/27 ...
          - (x.*y.^3*exp(-t/10).*(x - 2))./(270*(x/4 + y/4 - t*x.*y.*(x - 2).*(y - 3) - 33333/10000)) - (x.*y.^2*exp(-t/10).*(x ...
          - 2).*((t*x.*y.*(x - 2))/20 + (t*x.*(x - 2).*(y - 3))/20 - 1/16))/9 - (t*x.^2.*y.^3*exp(-t/10).*(x - 2).^2)/270 - (t*x.*y.^4*exp(...
          -t/10).*(x - 2).*(y - 3))/270 + (x.^2.*y.^4*exp(-t/10).*(x - 2).^2.*(y - 3))./(27*(x/4 + y/4 - t*x.*y.*(x - 2).*(y - 3) ...
          - 33333/10000).^2) - (x.*y.^5*exp(-t/5).*(x - 1).^2.*(x - 2))./((27000*y.^2*exp(-t/10).*(x - 1).^2 + 48600).*((x*exp(-t/10).*(x ...
          - 2).*y.^3)/27 - 2).*(x/4 + y/4 - t*x.*y.*(x - 2).*(y - 3) - 33333/10000));
%     G2 = diff(theta_sat*c1,t)-K*diff(diff(p,x)*c1,x)-K*diff(diff(p+y,y)*c1,y)-D1*diff(diff(c1,x),x)-D2*diff(diff(c1,y),y)-R1s
      G2 = @(t,x,y) (y.^3*exp(-t/10))/540 - (y.^3*exp(-t/10).*(x - 2).*(t*x.*y.*(y - 3) + t*y.*(x - 2).*(y - 3) - 1/4))/540 + (x.*y*exp(...
          -t/10).*(x - 2))/180 + (x.*y.^3*exp(-t/10).*(x - 2))/900 - (x.*y.^3*exp(-t/10).*(t*x.*y.*(y - 3) + t*y.*(x - 2).*(y - 3) ...
          - 1/4))/540 - (x.*y.^2*exp(-t/10).*(x - 2).*(t*x.*y.*(x - 2) + t*x.*(x - 2).*(y - 3) - 5/4))/180 - (t*x.^2.*y.^3*exp(-t/10).*(x ...
          - 2).^2)/270 - (t*x.*y.^4*exp(-t/10).*(x - 2).*(y - 3))/270 + (3*x.*y.^5*exp(-t/5).*(x - 1).^2.*(x - 2))./(10*(27000*y.^2*exp(...
          -t/10).*(x - 1).^2 + 48600).*((x*exp(-t/10).*(x - 2).*y.^3)/27 - 2));
%     H1 = diff(theta*c2,t)+diff(Vx*c2,x)+diff(Vy*c2,y)-D1*diff(diff(c2,x),x)-D2*diff(diff(c2,y),y)-R2
      H1 = @(t,x,y) (2*y*exp(-t/10).*(x - 1).^2.*((t*x.*y.*(x - 2))/20 + (t*x.*(x - 2).*(y - 3))/20 - 1/16))/9 - (exp(-t/10)*(x - 1).^2)/180 ...
          - (y.^2*exp(-t/10))/180 + (y.^2*exp(-t/10).*(x - 1).^2)./(90*(x/4 + y/4 - t*x.*y.*(x - 2).*(y - 3) - 33333/10000)) + (y.^2*exp(...
          -t/10).*(2*x - 2).*((t*x.*y.*(y - 3))/20 + (t*y.*(x - 2).*(y - 3))/20 - 1/80))/9 + (t*y.^3*exp(-t/10).*(x - 1).^2.*(y - 3))/90 ...
          + (t*x.*y.^2*exp(-t/10).*(x - 1).^2.*(x - 2))/90 - (x.*y.^3*exp(-t/10).*(x - 1).^2.*(x - 2).*(y - 3))./(9*(x/4 + y/4 - t*x.*y.*(x ...
          - 2).*(y - 3) - 33333/10000).^2) - (3*x.*y.^5*exp(-t/5).*(x - 1).^2.*(x - 2))./((27000*y.^2*exp(-t/10).*(x - 1).^2 ...
          + 48600).*((x*exp(-t/10).*(x - 2).*y.^3)/27 - 2).*(x/4 + y/4 - t*x.*y.*(x - 2).*(y - 3) - 33333/10000));
%     H2 = diff(theta_sat*c2,t)-K*diff(diff(p,x)*c2,x)-K*diff(diff(p+y,y)*c2,y)-D1*diff(diff(c2,x),x)-D2*diff(diff(c2,y),y)-R2s
      H2 = @(t,x,y) (y*exp(-t/10).*(x - 1).^2.*(t*x.*y.*(x - 2) + t*x.*(x - 2).*(y - 3) - 5/4))/90 - (exp(-t/10).*(x - 1).^2)/180 ...
          - (y.^2*exp(-t/10).*(x - 1).^2)/300 - (y.^2*exp(-t/10))/180 + (y.^2*exp(-t/10).*(2*x - 2).*(t*x.*y.*(y - 3) + t*y.*(x - 2).*(y ...
          - 3) - 1/4))/180 + (t*y.^3*exp(-t/10).*(x - 1).^2.*(y - 3))/90 + (t*x.*y.^2.*exp(-t/10).*(x - 1).^2.*(x - 2))/90 + (9*x.*y.^5*exp(...
          -t/5).*(x - 1).^2.*(x - 2))./(10*(27000.*y.^2*exp(-t/10).*(x - 1).^2 + 48600).*((x*exp(-t/10).*(x - 2).*y.^3)/27 - 2));

    fs_neg=F1(t,X,Y); fs_pos=F2(t,X,Y);
    fg_neg=G1(t,X,Y); fg_pos=G2(t,X,Y);
    fh_neg=H1(t,X,Y); fh_pos=H2(t,X,Y);
    pE=solEp(t,X,Y); neg=pE<0; 
    fs=fs_neg.*neg+fs_pos.*~neg;
    fg=fg_neg.*neg+fg_pos.*~neg;
    fh=fh_neg.*neg+fh_pos.*~neg;
